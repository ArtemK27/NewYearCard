<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Secret Gift</title>
    <style>
        /* --- –ë–ê–ó–ê --- */
        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
        body {
            background-color: #000;
            color: white;
            font-family: 'Courier New', Courier, monospace;
            height: 100vh; width: 100vw;
            overflow: hidden;
        }

        /* --- –ê–£–î–ò–û --- */
        audio { display: none; }

        /* --- 1. –ò–ù–¢–†–û (–î–í–ï–†–¨) --- */
        #intro-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 999;
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            transition: opacity 1s ease, transform 1s ease;
        }
        
        .door-container { 
            width: 70%; max-width: 300px; text-align: center; cursor: pointer; 
            position: relative;
        }

        .door-visual { 
            width: 100%; height: auto; 
            filter: brightness(0.6); /* –î–≤–µ—Ä—å —Ç–µ–º–Ω–∞—è –∏ –∑–ª–æ–≤–µ—â–∞—è */
            transition: filter 0.2s, transform 0.1s; 
        }
        
        /* –≠—Ñ—Ñ–µ–∫—Ç –Ω–∞–∂–∞—Ç–∏—è */
        .door-visual:active { filter: brightness(1.0); transform: scale(0.98); }

        .hint-text {
            margin-top: 20px; color: #555; font-size: 14px; font-family: Arial, sans-serif;
            text-transform: uppercase; letter-spacing: 3px; animation: pulse 2s infinite;
        }
        @keyframes pulse { 0%,100%{opacity:0.3} 50%{opacity:0.8} }

        /* –ñ–ï–°–¢–ö–ê–Ø –¢–†–Ø–°–ö–ê (SHAKE) */
        .shake-anim { animation: shake 0.3s cubic-bezier(.36,.07,.19,.97) both; }
        @keyframes shake { 
            10%, 90% { transform: translate3d(-3px, 0, 0) rotate(-1deg); } 
            20%, 80% { transform: translate3d(3px, 0, 0) rotate(1deg); }
            30%, 50%, 70% { transform: translate3d(-5px, 0, 0) rotate(-2deg); }
            40%, 60% { transform: translate3d(5px, 0, 0) rotate(2deg); }
        }

        /* –ê–Ω–∏–º–∞—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∏—è (–ó—É–º –≤–Ω—É—Ç—Ä—å) */
        .door-open-anim { animation: zoomInDoor 1s forwards; }
        @keyframes zoomInDoor {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(5); opacity: 0; }
        }

        /* --- 2. –ì–ê–õ–ï–†–ï–Ø --- */
        .gallery-container {
            display: flex; flex-direction: row;
            overflow-x: scroll; scroll-snap-type: x mandatory;
            width: 100vw; height: 100vh;
            scroll-behavior: smooth; scrollbar-width: none;
            opacity: 0; transition: opacity 1.5s ease;
        }
        .gallery-container::-webkit-scrollbar { display: none; }

        .slide {
            flex: 0 0 100vw; height: 100vh;
            scroll-snap-align: center; scroll-snap-stop: always;
            background: #000;
            display: flex; justify-content: center; align-items: center;
            padding: 20px;
        }

        .slide-card {
            position: relative; width: 100%; height: 100%; max-height: 850px;
            border-radius: 20px; overflow: hidden;
            box-shadow: 0 0 30px rgba(0, 0, 0, 1);
            background: #050505; border: 1px solid #222;
        }

        /* –û–ë–ï–†–¢–ö–ê –î–õ–Ø –≠–§–§–ï–ö–¢–û–í (Parallax Reveal) */
        .img-wrapper {
            width: 100%; height: 100%;
            overflow: hidden;
            background: #000;
        }

        .slide-media { 
            width: 100%; height: 100%; object-fit: cover; display: block; 
            /* –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: –£–≤–µ–ª–∏—á–µ–Ω–Ω–∞—è –∏ —Ç–µ–º–Ω–∞—è (–≤ —Ç–µ–Ω–∏) */
            transform: scale(1.2);
            filter: brightness(0.3) blur(5px);
            transition: transform 1.5s cubic-bezier(0.25, 0.46, 0.45, 0.94), filter 1.5s ease;
            will-change: transform, filter;
        }

        /* –ö–û–ì–î–ê –°–õ–ê–ô–î –ê–ö–¢–ò–í–ï–ù: –ö–∞—Ä—Ç–∏–Ω–∫–∞ "–ø—Ä–æ—è–≤–ª—è–µ—Ç—Å—è" */
        .slide.viewed .slide-media {
            transform: scale(1.05); /* –ü—Ä–∏—Ö–æ–¥–∏—Ç –ø–æ—á—Ç–∏ –≤ –Ω–æ—Ä–º—É, –Ω–æ –æ—Å—Ç–∞–µ—Ç—Å—è —á—É—Ç—å —É–≤–µ–ª–∏—á–µ–Ω–∞ –¥–ª—è –¥—ã—Ö–∞–Ω–∏—è */
            filter: brightness(1) blur(0);
        }

        /* –≠–§–§–ï–ö–¢ "–î–´–•–ê–ù–ò–Ø" (–ë–ª–µ—Å–∫ –≥–ª–∞–∑ / –ñ–∏–∑–Ω—å) */
        /* –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ —É–∂–µ –ø—Ä–æ—è–≤–ª–µ–Ω–Ω–æ–π –∫–∞—Ä—Ç–∏–Ω–∫–µ */
        .slide.viewed .slide-media.alive {
            animation: breathe 6s ease-in-out infinite alternate;
        }
        @keyframes breathe {
            0% { transform: scale(1.05); }
            100% { transform: scale(1.1); } /* –ú–µ–¥–ª–µ–Ω–Ω–æ–µ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ */
        }

        /* –ì–†–ê–î–ò–ï–ù–¢ –ò –¢–ï–ö–°–¢ */
        .gradient-overlay {
            position: absolute; bottom: 0; left: 0; width: 100%; height: 70%;
            background: linear-gradient(to top, #000 20%, transparent);
            pointer-events: none; z-index: 10;
        }

        .content-box {
            position: absolute; bottom: 30px; left: 20px; right: 20px; z-index: 20;
        }

        .char-name {
            font-family: 'Arial', sans-serif;
            font-size: 24px; font-weight: 900; color: #ff3333;
            margin-bottom: 10px; text-transform: uppercase;
            text-shadow: 0 2px 10px rgba(0,0,0,0.8);
            opacity: 0; transform: translateY(20px);
            transition: opacity 0.5s ease 0.5s, transform 0.5s ease 0.5s;
        }
        .slide.viewed .char-name { opacity: 1; transform: translateY(0); }

        .char-text {
            font-size: 16px; line-height: 1.5; color: #ddd;
            background: rgba(10, 10, 10, 0.7);
            padding: 15px; border-radius: 10px;
            border-left: 3px solid #ff3333;
            backdrop-filter: blur(5px);
            min-height: 60px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
        }

        .cursor::after { content: '|'; animation: blink 1s infinite; color: #ff3333; }
        @keyframes blink { 0%, 100% {opacity: 1;} 50% {opacity: 0;} }

        .gift-btn {
            display: block; width: 100%; text-align: center;
            background: #b30000; color: white;
            padding: 15px; border-radius: 30px;
            text-decoration: none; font-weight: bold; font-size: 18px; font-family: Arial, sans-serif;
            margin-top: 15px; box-shadow: 0 0 20px rgba(179, 0, 0, 0.6);
            opacity: 0; transition: opacity 1s; cursor: pointer; border: none;
        }
        .gift-btn.visible { opacity: 1; }

        /* –ú–û–î–ê–õ–ö–ê (QR) */
        #qr-modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95); z-index: 2000;
            display: none; justify-content: center; align-items: center;
            opacity: 0; transition: opacity 0.5s;
        }
        .ticket-card {
            background: linear-gradient(135deg, #1a1a1a, #3d0000);
            width: 300px; padding: 30px; border-radius: 20px; text-align: center;
            border: 2px solid #ff3333; box-shadow: 0 0 40px rgba(255, 51, 51, 0.3);
            transform: scale(0.5); transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .qr-image { width: 200px; height: 200px; background: white; padding: 10px; border-radius: 10px; margin: 20px auto; object-fit: contain; }
        .ticket-title { font-size: 22px; font-weight: bold; color: #fff; margin-bottom: 5px; letter-spacing: 2px; }
        .close-btn { margin-top: 15px; background: transparent; border: 1px solid #666; color: #aaa; padding: 8px 20px; border-radius: 20px; cursor: pointer; }
        .mobile-link { display: block; margin-top: 10px; color: #ff3333; font-size: 12px; }

        /* –°–ù–ï–ì */
        .snow-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 50; display: none; }
        .snowflake { position: absolute; top: -10px; background: white; opacity: 0.5; border-radius: 50%; animation: fall linear infinite; }
        @keyframes fall { to { transform: translateY(110vh); } }

    </style>
</head>
<body>

    <!-- –ó–í–£–ö–ò -->
    <audio id="bg-music" loop><source src="music.mp3" type="audio/mpeg"></audio>
    <audio id="knock-sound"><source src="knock.mp3" type="audio/mpeg"></audio>
    
    <div id="snow" class="snow-container"></div>

    <!-- –ò–ù–¢–†–û -->
    <div id="intro-screen" onclick="knock()">
        <div class="door-container">
            <img src="door.png" class="door-visual" id="door-img" alt="–î–≤–µ—Ä—å">
            <div class="hint-text" id="intro-text">–°—Ç—É–∫–Ω–∏ 3 —Ä–∞–∑–∞</div>
        </div>
    </div>

    <!-- –ì–ê–õ–ï–†–ï–Ø -->
    <div class="gallery-container" id="gallery">

        <!-- –°–ª–∞–π–¥ 1 -->
        <div class="slide">
            <div class="slide-card">
                <div class="img-wrapper">
                    <!-- class="alive" –¥–æ–±–∞–≤–ª—è–µ—Ç –¥—ã—Ö–∞–Ω–∏–µ -->
                    <img src="slide1.jpg" class="slide-media alive" alt="Sanwoo">
                </div>
                <div class="gradient-overlay"></div>
                <div class="content-box">
                    <div class="char-name">–°–ê–ù–£</div>
                    <div class="char-text" data-text="–¢—ã –Ω–∞–∫–æ–Ω–µ—Ü-—Ç–æ –ø—Ä–∏—à–ª–∞... –Ø –∂–¥–∞–ª —Ç–µ–±—è. –í —ç—Ç–æ–º –ø–æ–¥–≤–∞–ª–µ –≤—Ä–µ–º—è –∏–¥–µ—Ç –∏–Ω–∞—á–µ."></div>
                </div>
            </div>
        </div>

        <!-- –°–ª–∞–π–¥ 2 -->
        <div class="slide">
            <div class="slide-card">
                <div class="img-wrapper">
                    <img src="slide2.jpg" class="slide-media alive" alt="Bum">
                </div>
                <div class="gradient-overlay"></div>
                <div class="content-box">
                    <div class="char-name" style="color: rgb(3, 185, 48);">–Æ–ù–ë–£–ú</div>
                    <div class="char-text" style="color: rgb(3, 185, 48);" data-text="–ü-–ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —Ç–æ–ª—å–∫–æ —Ç–∏—Ö–æ... –°–∞–Ω—É –Ω–µ –ª—é–±–∏—Ç —à—É–º. –ù–æ –¥–ª—è —Ç–µ–±—è –æ–Ω —Ä–∞–∑—Ä–µ—à–∏–ª –ø—Ä–∞–∑–¥–Ω–∏–∫."></div>
                </div>
            </div>
        </div>

        <!-- –°–ª–∞–π–¥ 3 -->
        <div class="slide">
            <div class="slide-card">
                <div class="img-wrapper">
                    <img src="slide3.jpg" class="slide-media alive" alt="Nii-chan">
                </div>
                <div class="gradient-overlay"></div>
                <div class="content-box">
                    <div class="char-name" style="color: rgb(16, 173, 221);" >–ù–ò–ò-–ß–ê–ù</div>
                    <div class="char-text" style="color: rgb(16, 173, 221);" data-text="–Ø –≤—Å–µ–≥–¥–∞ –∑–Ω–∞–ª, –∫–∞–∫ —Ç–µ–±—è –∑–∞–º–∞–Ω–∏—Ç—å. –ù–æ–≤—ã–π –≥–æ–¥ ‚Äî –≤—Ä–µ–º—è –¥–ª—è —Å–µ–∫—Ä–µ—Ç–æ–≤. –ü—Ä–∏—Ö–æ–¥–∏ –±–ª–∏–∂–µ, —è —É–≥–æ—Å—Ç—é... —Ñ–µ–π–µ—Ä–≤–µ—Ä–∫–æ–º."></div>
                </div>
            </div>
        </div>

        <!-- –°–ª–∞–π–¥ 4 -->
        <div class="slide">
            <div class="slide-card">
                <div class="img-wrapper">
                    <img src="slide4.jpg" class="slide-media alive" alt="Yui">
                </div>
                <div class="gradient-overlay"></div>
                <div class="content-box">
                    <div class="char-name" style="color: rgb(202, 223, 16);">–Æ–∏</div>
                    <div class="char-text" style="color: rgb(202, 223, 16);" data-text="–¢—ã –æ—Ç–∫—Ä—ã–ª–∞ –¥–≤–µ—Ä—å... –∫–∞–∫ –≤ —Ç–µ –≤—Ä–µ–º–µ–Ω–∞, –∫–æ–≥–¥–∞ —è –∂–¥–∞–ª '–Ω–∏–∏-—á–∞–Ω–∞'. –ù–æ —Ç–µ–ø–µ—Ä—å –ù–æ–≤—ã–π –≥–æ–¥, –∏ —è –Ω–µ –±–æ—é—Å—å. –¢—ã ‚Äî –º–æ–π —Å–≤–µ—Ç –≤ —Ç–µ–º–Ω–æ—Ç–µ. –° –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–º, –¥–∞–≤–∞–π –ø–æ–∏–≥—Ä–∞–µ–º?"></div>
                </div>
            </div>
        </div>

        <!-- –°–ª–∞–π–¥ (–í–ò–î–ï–û) -->
        <div class="slide">
            <div class="slide-card">
                <div class="img-wrapper">
                    <video class="slide-media" autoplay muted loop playsinline poster="cover.jpg">
                        <source src="video.mp4" type="video/mp4">
                    </video>
                </div>
                <div class="gradient-overlay"></div>
                <div class="content-box">
                    <div class="char-name">SPECIAL</div>
                    <div class="char-text" data-text="–°–º–æ—Ç—Ä–∏ –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ. –≠—Ç–æ —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–≤–æ–∏—Ö –≥–ª–∞–∑."></div>
                </div>
            </div>
        </div>

        <!-- –°–ª–∞–π–¥ 5 (–ü–û–î–ê–†–û–ö) -->
        <div class="slide">
            <div class="slide-card">
                <div class="img-wrapper">
                    <img src="gift_bg.jpg" class="slide-media" alt="Gift">
                </div>
                <div class="gradient-overlay"></div>
                <div class="content-box" style="bottom: 60px;">
                    <div class="char-name" style="text-align: center; color: #fff;">–¢–í–û–ô –ü–û–î–ê–†–û–ö</div>
                    <div class="char-text" style="text-align: center;" data-text="–¢—ã –ø–µ—Ä–µ–∂–∏–ª–∞ —ç—Ç–æ—Ç –≥–æ–¥. –¢—ã —É–º–Ω–∏—Ü–∞. –ó–∞–±–∏—Ä–∞–π —Å–≤–æ–π –ø–æ–¥–∞—Ä–æ–∫!"></div>
                    <button class="gift-btn" id="final-btn" onclick="openQR()">üéÅ –ü–û–õ–£–ß–ò–¢–¨ –î–û–°–¢–£–ü</button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–ö–ê -->
    <div id="qr-modal">
        <div class="ticket-card">
            <div class="ticket-title">VIP PASS</div>
            <div class="ticket-desc">–î–æ—Å—Ç—É–ø –∫ —Å–µ–∫—Ä–µ—Ç–Ω–æ–º—É –ø–æ–¥–∞—Ä–∫—É</div>
            <img src="qr.png" class="qr-image" alt="QR">
            <a href="https://t.me/—Ç–≤–æ—è_—Å—Å—ã–ª–∫–∞" class="mobile-link" target="_blank">–ù–µ —Å–∫–∞–Ω–∏—Ä—É–µ—Ç—Å—è? –ù–∞–∂–º–∏ —Å—é–¥–∞</a>
            <button class="close-btn" onclick="closeQR()">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <script>
        let knocks = 0;
        const doorImg = document.getElementById('door-img');
        const introText = document.getElementById('intro-text');
        const introScreen = document.getElementById('intro-screen');
        const gallery = document.getElementById('gallery');
        const bgMusic = document.getElementById('bg-music');
        const knockSound = document.getElementById('knock-sound');
        const snow = document.getElementById('snow');
        const slides = document.querySelectorAll('.slide');
        const qrModal = document.getElementById('qr-modal');
        const qrCard = document.querySelector('.ticket-card');

        // --- –£–ü–†–ê–í–õ–ï–ù–ò–ï –ú–£–ó–´–ö–û–ô ---
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) { bgMusic.pause(); } 
            else { if (knocks >= 1) bgMusic.play().catch(e=>{}); }
        });

        // --- –õ–û–ì–ò–ö–ê –î–í–ï–†–ò ---
        function knock() {
            knocks++;
            
            // –ó–í–£–ö: –°—Ç—É–∫ –Ω–∞ –∫–∞–∂–¥—ã–π –∫–ª–∏–∫
            knockSound.currentTime = 0; // –ü–µ—Ä–µ–º–æ—Ç–∫–∞ –≤ –Ω–∞—á–∞–ª–æ, –µ—Å–ª–∏ –∫–ª–∏–∫–∞—é—Ç –±—ã—Å—Ç—Ä–æ
            knockSound.play().catch(e=>{});

            // –ó–í–£–ö: –§–æ–Ω –Ω–∞ 1 –∫–ª–∏–∫
            if (knocks === 1) { 
                bgMusic.volume = 0.5; 
                bgMusic.play().catch(e=>{}); 
            }

            // –í–ò–ë–†–ê–¶–ò–Ø: –°–∏–ª—å–Ω–∞—è
            if (navigator.vibrate) navigator.vibrate(70);

            // –ê–ù–ò–ú–ê–¶–ò–Ø: –¢—Ä—è—Å–∫–∞
            doorImg.classList.remove('shake-anim');
            void doorImg.offsetWidth;
            doorImg.classList.add('shake-anim');

            // –¢–ï–ö–°–¢
            if(knocks === 1) introText.innerText = "–ö–¢–û –¢–ê–ú?";
            if(knocks === 2) introText.innerText = "–ï–©–Å...";
            
            // –û–¢–ö–†–´–¢–ò–ï (3 –∫–ª–∏–∫)
            if(knocks === 3) {
                introText.style.opacity = 0;
                // –≠—Ñ—Ñ–µ–∫—Ç –∑—É–º–∞ –¥–≤–µ—Ä–∏ –≤–Ω—É—Ç—Ä—å
                document.querySelector('.door-container').classList.add('door-open-anim');
                
                // –ñ–¥–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –∑—É–º–∞ 0.8 —Å–µ–∫
                setTimeout(() => {
                    introScreen.style.opacity = '0';
                    introScreen.style.pointerEvents = 'none';
                    
                    gallery.style.opacity = '1';
                    snow.style.display = 'block';
                    createSnow();

                    // –ó–∞–ø—É—Å–∫ –≥–∞–ª–µ—Ä–µ–∏
                    setTimeout(() => {
                        startObserving();
                        introScreen.style.display = 'none';
                    }, 100);
                }, 800);
            }
        }

        // --- QR ---
        function openQR() {
            qrModal.style.display = 'flex';
            setTimeout(() => { qrModal.style.opacity = '1'; qrCard.style.transform = 'scale(1)'; }, 10);
            if (navigator.vibrate) navigator.vibrate([50, 50, 50]);
        }
        function closeQR() {
            qrModal.style.opacity = '0'; qrCard.style.transform = 'scale(0.5)';
            setTimeout(() => { qrModal.style.display = 'none'; }, 500);
        }

        // --- –ü–ï–ß–ê–¢–ù–ê–Ø –ú–ê–®–ò–ù–ö–ê ---
        function typeWriter(element, text, speed = 40) {
            if (element.classList.contains('typed')) return;
            element.innerHTML = '<span class="cursor"></span>';
            element.classList.add('typed');
            let i = 0;
            function type() {
                if (i < text.length) {
                    element.innerHTML = text.substring(0, i + 1) + '<span class="cursor"></span>';
                    i++; setTimeout(type, speed);
                } else {
                    if (element.nextElementSibling && element.nextElementSibling.classList.contains('gift-btn')) {
                        element.nextElementSibling.classList.add('visible');
                    }
                }
            }
            type();
        }

        // --- PARALLAX & REVEAL ---
        function startObserving() {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        if (navigator.vibrate) navigator.vibrate(20);
                        
                        // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å viewed –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∞–Ω–∏–º–∞—Ü–∏–∏ "–≤—ã—Ö–æ–¥–∞ –∏–∑ —Ç–µ–Ω–∏"
                        entry.target.classList.add('viewed');

                        const textBox = entry.target.querySelector('.char-text');
                        const textToType = textBox.getAttribute('data-text');
                        // –ü–µ—á–∞—Ç–∞–µ–º —Ç–µ–∫—Å—Ç —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π, —á—Ç–æ–±—ã –∫–∞—Ä—Ç–∏–Ω–∫–∞ —É—Å–ø–µ–ª–∞ "–ø—Ä–æ—è–≤–∏—Ç—å—Å—è"
                        setTimeout(() => {
                            if (textToType) typeWriter(textBox, textToType, 40);
                        }, 600);
                    }
                });
            }, { threshold: 0.5 });
            slides.forEach(slide => observer.observe(slide));
        }

        // --- –°–ù–ï–ì ---
        function createSnow() {
            const snowContainer = document.getElementById('snow');
            for (let i = 0; i < 30; i++) {
                const snowflake = document.createElement('div');
                snowflake.classList.add('snowflake');
                snowflake.style.left = Math.random() * 100 + 'vw';
                snowflake.style.width = snowflake.style.height = (Math.random() * 4 + 2) + 'px';
                snowflake.style.animationDuration = (Math.random() * 3 + 2) + 's';
                snowflake.style.opacity = Math.random() * 0.5 + 0.1;
                snowflake.style.background = '#ccc'; 
                snowContainer.appendChild(snowflake);
            }
        }
    </script>
</body>
</html>